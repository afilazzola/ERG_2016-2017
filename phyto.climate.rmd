---
title: 'The effect of a dominant shrub on annuals plants in a desert system changes along a gradient of precipitation.'
author: "Alex Filazzola"
date: "May 2017"
output:
  html_document:
    theme: yeti
    toc: yes
    toc_float: yes
    toc_depth: 3
  
---
### Appendix B  - compare phytometer with climate data


### Load libraries
```{r load packages, echo=FALSE, warning=FALSE, message=FALSE}
## load packages for spatial manipulation
library(raster)
library(rgdal)
library(dismo)
library(tidyverse)
```


### Download species occurrences and load rasters
```{r}
## list species
genus <- c("Phacelia","Plantago","Salvia")
species <- c("tanacetifolia","ovata","columbariae")

## run download for each 
for(i in 1:length(genus))
{
temp <- gbif(genus[i],species[i]) ## extract species name from GBIF server
temp<-na.omit(temp[,c("lon","lat")]) ## remove all columns except lat-long
temp <- temp[!duplicated(temp), ] ## duplicated occurences
temp["species.name"]<- rep(paste(genus[i]," ",species[i]),nrow(temp)) ##generate column for species name
write.csv(temp, paste("Data\\occurrence\\",genus[i],".",species[i], ".csv"),row.names=F, sep="") ##write csv with species occurences
}

pha <- read.csv("Data\\occurrence\\Phacelia.tanacetifolia.csv")
pla <- read.csv("Data\\occurrence\\Plantago.ovata.csv")
sal <- read.csv("Data\\occurrence\\Salvia.columbariae.csv")


## load rasters
r1 <- raster("rasters\\bio 1.tif") #annual temp
r2 <- raster("rasters\\bio 12.tif") #annual precipitation
r3 <- raster("rasters\\bio 8.tif") #temp wettest quarter
r4 <- raster("rasters\\bio 16.tif") #precipitation wettest quarter

calclim <- stack(r1,r2,r3,r4)
names(calclim) <- c("Temp","Precip","Temp wettest QR","Precipt wettest QR")

## get California outline
us <- raster::getData("GADM", country="USA", level=1) ## use state bounds from gadm website:
cal<- c("California") ## extract states (need to uppercase everything)
cal = us[match(toupper(cal),toupper(us$NAME_1)),]

calclim <- crop(calclim, cal)
```


### Extract climate data
```{r}
## combine species list
occ.spp <- rbind(pha,pla,sal)


## extract climate data
clim.spp <- extract(calclim, occ.spp)






